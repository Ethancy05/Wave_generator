# Wave_generator
简易函数发生器
<https://bbs.huaweicloud.com/blogs/234913>
# 1.目的
要求通过按键控制输出两种波形，矩形和正弦波，频率50HZ-20KHZ可调，峰值0~3.3V。   
选做：测量正弦波频率。
# 2.方案
## 2.1 DAC
STM32F4的DAC是12位数字输入，电压输出型DAC，DAC可以按照8位或12位进行配置(12位模式下可配置左对齐或右对齐)，有两个DAC转换器，各对应一个输出通道.

在触发方式中，TIM6和TIM7是基本定时器，配置简单，因此可以选择这两种触发方式。且在如下的参考手册中也可以看到，TIM6,7可以专门用于驱动DAC。

**DAC与DMA**

**DAC输出电压：**

```math
VDACout = Vref*(DOR/4095)
```
Vref一般为3.3V。   

本方案中，DAC用TIM6触发，TIM6挂载在APB1总线上，时钟频率84MHZ   

正玄波采用函数输出，具体思路是电压值*正弦函数的值，用正弦函数的比值来确定输出电压值，进而算出寄存器值。   
矩形波思路较为简单，峰值和0即可。

波形频率体现在界面上就是波形周期，反应在DAC上就是分隔数*DAC周期

    
    psc = 20

## 2.2  ADC